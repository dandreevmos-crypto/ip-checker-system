# Изменения в IP Checker System - Интеграция API Роспатента

**Дата:** 04.02.2026

## Выполненные работы

### 1. Интеграция API Роспатента

Добавлена поддержка официального API платформы Роспатента для патентного поиска.

**Конфигурация API ключа:**
- Файл: `src/config.py`
- Ключ добавлен в словарь `API_KEYS["rospatent"]`
- API ключ: `0deb6def77394a5fbb0dd1af0571c336`

**Обновлённые файлы:**
- `src/trademark_checker.py` - класс `RospatentPlatformChecker`

### 2. Особенности API Роспатента

**Важно:** Открытый API Роспатента (`/patsearch/v0.2/`) предназначен для **патентного поиска**, а не для поиска товарных знаков напрямую.

- **URL API:** `https://searchplatform.rospatent.gov.ru/patsearch/v0.2/`
- **Авторизация:** Bearer token
- **Метод:** POST /search
- **Таймаут:** 60 секунд

Для полноценной проверки товарных знаков рекомендуется использовать веб-интерфейс:
- https://searchplatform.rospatent.gov.ru/trademarks

### 3. Логика работы

Система теперь работает следующим образом:

1. **Роспатент API (патенты):**
   - Ищет по патентной базе
   - Если найдены документы с точным совпадением → ЖЁЛТЫЙ (требуется ручная проверка ТЗ)
   - Если найдены документы без высокого сходства → ЗЕЛЁНЫЙ + ссылка на ручную проверку
   - Если ошибка → ЖЁЛТЫЙ + ссылка на ручную проверку

2. **Linkmark:**
   - Рекомендуется ручная проверка (нет открытого API)

3. **WIPO:**
   - Защищён CAPTCHA, рекомендуется ручная проверка

### 4. Ссылки для ручной проверки

Система генерирует ссылки для ручной проверки:
- EUIPO
- Linkmark
- WIPO Global Brand
- Платформа Роспатента (товарные знаки)
- ФИПС (бюллетени)
- ФИПС (реестр)

## Результат тестирования

Поиск "Taccardi":
- **Роспатент:** Найдено 114 патентов, без высокого сходства → ЗЕЛЁНЫЙ
- **Linkmark:** Требуется ручная проверка → ЖЁЛТЫЙ
- **WIPO:** Требуется ручная проверка (CAPTCHA) → ЖЁЛТЫЙ

## Обновление: Интеграция Linkmark

### Добавлена полноценная интеграция с Linkmark

Linkmark.ru - бесплатный сервис поиска товарных знаков РФ, который получает данные из базы ФИПС/Роспатента.

**Как работает:**
1. POST запрос на `https://linkmark.ru/search` с параметром `search={запрос}`
2. Сайт возвращает редирект на страницу результатов
3. Парсинг HTML страницы для извлечения:
   - Количества найденных ТЗ и заявок
   - Номеров свидетельств
   - Классов МКТУ
   - Правообладателей
   - Статусов (действует/не действует)

**Результаты тестирования "Taccardi":**
- Найдено **1613 товарных знаков**
- Найдено **764 заявки**
- **Статус: ЗАПРЕЩЕНО** (красный)

Теперь система правильно определяет, что бренд "Taccardi" уже зарегистрирован!

## Дальнейшие улучшения

Возможные улучшения:

1. **WIPO API** - требует решения CAPTCHA (можно использовать сторонние сервисы)
2. **EUIPO API** - можно добавить парсинг аналогично Linkmark
3. **Кэширование** - для ускорения повторных запросов

## Запуск системы

```bash
cd /Users/olgaandreeva/Documents/Claude/Search\ trademarks\ and\ picture/ip_checker_system
./venv/bin/python run.py
```

Веб-интерфейс: http://127.0.0.1:5001
