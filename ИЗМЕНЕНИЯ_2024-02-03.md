# Изменения в IP Checker System
## Дата: 3 февраля 2024

---

## Проблема

Система не запускалась — процессы Python зависали при импорте библиотек.

### Причины:
1. **Тяжёлые зависимости** в `requirements.txt`:
   - `easyocr` — включает PyTorch (~2GB), очень долго загружается
   - `opencv-python` — тяжёлая библиотека компьютерного зрения
   - `selenium` — автоматизация браузера, требует драйверы
   - `aiohttp`, `asyncio` — асинхронные библиотеки с конфликтами версий

2. **Повреждённый venv** — виртуальное окружение было в нерабочем состоянии

3. **Порт 5000 занят** — на macOS порт 5000 используется системным процессом Control Center

---

## Что было сделано

### 1. Удалён старый venv
```bash
rm -rf venv
```

### 2. Создан облегчённый файл зависимостей

Новый файл: `requirements_light.txt`

Убраны тяжёлые библиотеки:
- ❌ easyocr
- ❌ opencv-python
- ❌ selenium
- ❌ webdriver-manager
- ❌ aiohttp
- ❌ asyncio
- ❌ anthropic

Оставлены необходимые:
- ✅ flask, flask-cors
- ✅ requests, beautifulsoup4, httpx
- ✅ pandas, openpyxl, xlsxwriter
- ✅ Pillow, imagehash
- ✅ Levenshtein, transliterate
- ✅ tqdm, python-dotenv

### 3. Создан новый venv и установлены зависимости
```bash
python3 -m venv venv
./venv/bin/pip install --upgrade pip
./venv/bin/pip install -r requirements_light.txt
./venv/bin/pip install imagehash
```

### 4. Изменён порт с 5000 на 5001

Файл: `src/config.py`, строка 212:
```python
# Было:
"port": 5000,

# Стало:
"port": 5001,
```

---

## Как запустить систему

```bash
cd "/Users/olgaandreeva/Documents/Claude/Search trademarks and picture/ip_checker_system"
./venv/bin/python run.py
```

Затем открыть в браузере: **http://127.0.0.1:5001**

---

## Ограничения после изменений

Из-за удаления тяжёлых библиотек некоторые функции могут быть ограничены:

| Функция | Статус | Примечание |
|---------|--------|------------|
| Веб-интерфейс | ✅ Работает | Flask |
| Загрузка Excel/CSV | ✅ Работает | Pandas |
| Поиск по базам ТЗ | ✅ Работает | Requests + BeautifulSoup |
| Анализ изображений | ⚠️ Базовый | Только Pillow + imagehash |
| OCR (распознавание текста) | ❌ Отключено | Требует easyocr/pytesseract |
| Автоматизация браузера | ❌ Отключено | Требует selenium |

---

## Восстановление полной функциональности

Если нужны все функции, можно установить полные зависимости (займёт больше времени и места):

```bash
./venv/bin/pip install -r requirements.txt
```

**Внимание:** Это установит ~3-4 GB библиотек и может занять 10-30 минут.

---

## Файлы проекта

```
ip_checker_system/
├── venv/                    # Виртуальное окружение (пересоздано)
├── src/
│   ├── app.py              # Flask приложение
│   ├── config.py           # Конфигурация (порт изменён на 5001)
│   ├── trademark_checker.py
│   ├── image_checker.py
│   ├── risk_evaluator.py
│   ├── export_manager.py
│   ├── data_loader.py
│   └── models.py
├── templates/
│   └── index.html          # Веб-интерфейс
├── static/
├── data/
├── output/
├── requirements.txt        # Полные зависимости (оригинал)
├── requirements_light.txt  # Облегчённые зависимости (новый)
├── run.py                  # Скрипт запуска
├── ИНСТРУКЦИЯ.md
└── ИЗМЕНЕНИЯ_2024-02-03.md # Этот файл
```
